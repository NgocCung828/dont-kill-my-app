---
name: Huawei
subtitle: except Nexus 6P
manufacturer:
  - huawei
redirect_from: /vendors/huawei.html
award: 5
position: 3
explanation: "<div class='caution-box'>\n<strong>UPDATE</strong>: On some phones with EMUI 9+ (Android P+) Huawei introduced a new task killer app called PowerGenie which kills everything not whitelisted by Huawei and does not give users any configuration options. See below how to uninstall it.\n<br>\nWe have mixed reviews on Huawei - the PowerGenie app is present on some EMUI 9+ systems, while on others it isn't.\n</div>\nTraditionally Huawei and their Android customization called EMUI belongs to the most troubled on the market with respect to non-standard background process limitations.\nThere are no APIs and no documentation for those extensions. On default settings, background processing simply does not work right and apps working in background will break.\nIn some of the EMUI versions (we know about EMUI 4 at and we have some reports about EMUI 5 and now the latest EMUI 9) no user accessible settings can prevent the system to break background processing longer than 60 minutes. This is done by an evil custom service called HwPFWService (and in EMUI 9 this is called PowerGenie) developed and bundled with EMUI by Huawei."
user_solution: "### App Launch on some EMUI 8, 9 and 10 devices (Huawei P20, Huawei P20 Lite, Huawei Mate 10...)\n* *Phone settings > Battery > App launch* and then set your app to “Manage manually” and make sure everything is turned on.\n<div class=\"img-block\">\n  <figure>\n    <img src=\"/assets/img/huawei/ss_huawei_app_launch_1.png\">\n    <figcaption>1. *Phone settings > Battery > App launch*. This feature may or may not be available for all devices or labeled differently.</figcaption>\n  </figure>\n  <figure>\n    <img src=\"/assets/img/huawei/ss_huawei_app_launch_3.png\">\n    <figcaption>2. Turn off “Manage all autmatically”</figcaption>\n  </figure>\n  <figure>\n    <img src=\"/assets/img/huawei/ss_huawei_app_launch_4.png\">\n    <figcaption>3. Make sure to ENABLE! all toggles.</figcaption>\n  </figure>\n</div>\nAlso for reliable background processes you may need to uninstall PowerGenie as described below.\n### Startup manager\nStartup manager seems to be a new kid on the block, preventing apps run automatically after the phone starts up.\n* Go to Settings > All > Startup manager.\n<div class=\"img-block\">\n  <figure>\n    <img src=\"/assets/img/huawei/startup.jpg\">\n    <figcaption>1. *Phone settings > All > Startup manager* and allow the app.</figcaption>\n  </figure>\n</div>\n### EMUI 9+ devices\n#### Classic battery optimization\nOpen Settings, and search for and access Battery optimization. Touch the little inverted triangle next to Don't allow, touch All apps, locate and touch your app, and select Don't allow.\n#### PowerGenie\nHuawei is extremely inventive in breaking apps on their devices. In addition to all the non-standard power management measures described below, they introduced a new task killer app build right into EMUI 9 on Android Pie.\nIt is called <b>PowerGenie</b> and it kills all apps that are not on its whitelist. You cannot add custom apps on their pre-defined whitelist. This means there is no other way to fix proper app functionality on Huawei than uninstalling PowerGenie.\nUnfortunately this is a system app and can only be fully uninstalled using ADB (Android Debug Bridge) Source: [XDA](https://forum.xda-developers.com/mate-20-pro/themes/remove-powergenie-to-allow-background-t3890409).\nYou need to:\n1. [install ADB](https://www.xda-developers.com/install-adb-windows-macos-linux/) on your computer\n2. Connect your phone with a data cable\n3. Enable [Developer options](https://developer.android.com/studio/debug/dev-options.html)\n4. Enable USB debugging within Developer options on your device\n5. Run the following commands on your computer:\n`adb shell pm uninstall -k --user 0 com.huawei.powergenie`\n`adb shell pm uninstall -k --user 0 com.huawei.android.hwaps`\nIf apps keep getting killed try running `adb shell pm stopservice hwPfwService`.\nWe did not yet have this confirmed but it is possible you can alternatively just disable PowerGenie in *Phone settings > Apps*. This setting would need to be re-applied every time you reboot your device.\n<div class=\"caution-box\">\nPlease still follow the steps below - Huawei phones usually have multiple powersaving mechanisms.\n<br><br>\nAlso, you may not have PowerGenie on your device, but your apps may still get killed by another mechanism.\n</div>\n### EMUI 5.X and 8.X\n#### Classic battery optimization\nOpen Settings, and search for and access Ignore battery optimization. Touch the little inverted triangle next to Allow, touch All apps, locate and touch the app, and select Allow.\n### EMUI 6+ devices (and some EMUI 5 devices)\n* *Phone settings > Advanced Settings > Battery manager > Power plan* set to *Performance*\n* *Phone Settings > Advanced Settings > Battery Manager > Protected apps* – set your app as *Protected*\n* *Phone Settings > Apps > Your app > Battery > Power-intensive prompt* [uncheck] and *Keep running after screen off* [check]\n* *Phone settings > Apps > Advanced (At the bottom) > Ignore optimisations >* Press *Allowed > All apps >* Find your app on the list and set to *Allow*\n### Huawei P9 Plus\n* *Phone settings > Apps > Settings > Special access > Ignore battery optimisation >* select allow for your app.\n### Huawei Honor 9 Lite, Huawei Mate 9 Pro\n* *Phone settings > Battery > Launch* and then set your app to “Manage manually” and make sure everything is turned on.\nOn EMUI 4 there is no way out, sorry, but you can ask developers of your apps to implement the workaround described in <a href=\"#developer-solution-section\">Developer section</a>"
developer_solution: "### EMUI 4\nOn EMUI 4 Huawei implemented an evil service called `HwPFWService`. In your `adb logcat` you can see message like:\n```\n[ 05-25 18:10:17.167 4230:16683 D/PFW.HwPFWAppWakeLockPolicy ]\ngetUidWakeLock uid: 10185 wakelock >= 10 mins\n[ 05-25 18:10:17.249 4230:16683 W/PFW.HwPFWAppWakeLockPolicy ]\nuid: 10185 wakelock > 60 mins\n[ 05-25 18:10:17.249 4230:16683 D/PFW.HwPFWAppWakeLockPolicy ]\nforce stop abnormal wakelock app uid: 10185\n```\nThe good news is that in order to not kill itself or others, Huawei/Honor's services, before killing an app, hwPfwService looks at the tag of the wakelock and if the tag is one the hard-coded whitelisted tags, it does not kill the app.\nThe whitelisted wakelock tags are: \"AudioMix\", \"AudioIn\", \"AudioDup\", \"AudioDirectOut\", \"AudioOffload\" and \"LocationManagerService\".\nHere is how you can workaround this in code:\n```\nString tag = \"com.my_app:LOCK\";\nif (Build.VERSION.SDK_INT == Build.VERSION_CODES.M && Build.MANUFACTURER.equals(\"Huawei\")) {\n    tag = \"LocationManagerService\";\n}\nPowerManager.WakeLock wakeLock = ((PowerManager) getSystemService(Context.POWER_SERVICE)).newWakeLock(1, tag);\nwakeLock.acquire();\n```"
---

